## Основные команды

- **docker run** - инициализация нового контейнера, преобразования образа в контейнер 
  - `docker run -h CONTAINER -i -t debian /bin/bash`	
	  - **-h** -  имя хоста
	  - **-i** и **-t** сообщают Docker, что необходимо создать сеанс интерактивной работы на подключаемом терминальном устройстве tty
	  - **/bin/bash** - инициализирует командную оболочку bash
  - `docker run test/cowsay-dockerfile`	  
  - `docker run --name myredis -d redis`
  	- **-d** сообщает Docker, что контейнер нужно запустить в фоновом режиме
  - `docker run --rm test/cowsay-dockerfile`	
  	- **--rm** - позволяет удалить остановленный контейнер после работы
  - ` docker run -e var1=val -e var2="val 2" debian env`	
  	- **-e, --env** - Определяет переменные среды внутри контейнера
  - `docker run --name myContainerName linnikoleh/cowsay-dockerfile`	
  	- **--name NAME** - Присваивает контейнеру имя NAME
  	- **--expose** - Аналог инструкции **EXPOSE** из файла Dockerfile. Определяет номер порта или диапазон номеров портов, предназначенных для использования в контейнере
  	- **-p --publish** - «Публикует» порт данного контейнера, то есть делает его доступным с хоста.
                         Если соответствующий порт хоста не определен, то произвольным образом выбирается свободный порт с большим номером 
    - **-P, --publish-all** - Объявляет все порты, открываемые в контейнере, доступными на хосте                     
    - **--entrypoint** - Определяет точку входа для запускаемого контейнера в соответствии с заданным аргументом, заменяя содержимое любой инструкции **ENTRYPOINT** из Dockerfile.
    - **-w, --workdir** - Устанавливает рабочий каталог в контейнере в соответствии с заданным путевым именем. Заменяет любые значения, определенные в файле Dockerfile
  - **docker run -d -p 5000:5000 -v "$(pwd)"/app:/app identidock**  
  	- **-v "$(pwd)"/app:/app** -  позволяет смонтировать подкаталог app из текущего рабочего каталога хоста на каталог /app внутри контейнера. 
  	                              Старое содержимое каталога /app контейнера заменяется новым, при этом сохраняется возможность записи в этот каталог
  - **docker run -e ENV=DEV -p 5000:5000 identidock** - запуск контейнера с переменной ENV
  
- **docker ps** 
	- `docker ps` - позволяет нам узнать некоторые подробности обо всех контейнерах, работающих в текущий момент
	- `docker ps -a` - выводится список всех контейнеров, включая остановленные

- **docker inspect** - Больше информации о конкретном контейнере с указанием имени или идентификатора нужного контейнера `docker inspect stupefied_turing`
	- `docker inspect stupefied_turing | grep IPAddress` - для выделения той информации, которая вас интересует
	- `docker inspect --format {{.NetworkSettings.IPAddress}} stupefied_turing` - для выделения той информации, которая вас интересует
	
- **docker diff** -  список файлов, измененных в работающем контейнере     
	-  `docker diff stupefied_turing` - задается имя контейнера или идентификатора  
	
- **docker logs** - будет выведен список всех событий, произошедших внутри заданного контейнера	    
	- `docker logs stupefied_turing` - задается имя контейнера или идентификатора        
	
- **docker rm**	- окончательно избавиться от контейнера
	- `docker rm stupefied_turing` - задается имя контейнера или идентификатора
	- `docker rm -v $(docker ps -aq -f status=exited)` - удалить все остановленные контейнеры
	- `docker rm $(docker ps -aq)` - удалить все контейнеры
	
- **docker commit**	- для превращения контейнера в образ. Необходимо передать в команду имя контейнера
                       («cowsay»), имя для создаваемого образа («cowsayimage»), а также имя
                        репозитория, в котором образ будет сохранен («test»)
	- `docker commit cowsay test/cowsayimage`                        
	
- **docker build** - создать образ	
	- `docker build -t test/cowsay-dockerfile .`
		- **-t** - задается имя
	
-  **docker exec** - Запускает заданную команду внутри контейнера. Может использоваться для выполнения задач сопровождения или в качестве замены ssh при входе 
 	`docker exec -it $containerid /bin/bash` - чтобы зайти в файловую систему контейнера
 	
- **docker history** - Весь набор уровней, формирующих образ,
	- `docker history test/cowsay-dockerfile` 
	
- **docker port**- 	Чтобы определить номера портов, назначенные механизмом Docker
	- `docker port -p 8000:80 objective_mahavira` - 80/tcp -> 0.0.0.0:8000. 
	Аргумент -p 8000:80 сообщил механизму Docker о необходимости перенаправления порта 8000 хоста на порт 80 в контейнере
	
- **docker create** - 	Создает контейнер из заданного образа, но не запускает его. Аргументы этой
                        команды в основном те же, что для команды `docker run`. Чтобы запустить созданный
                        контейнер, нужно выполнить команду `docker start`
                        
- **docker cp** -  Позволяет копировать файлы между файловыми системами контейнера и хоста                       
                        
- **docker kill** - Посылает сигнал основному процессу (PID=1) в контейнере.
	
- **docker pause** - Временно приостанавливает все процессы внутри заданного контейнера.  
                     Продолжить выполнение этих процессов можно с помощью команды **docker unpause** 

- **docker restart** - Перезапускает один или несколько контейнеров. Можно считать приблизительным
                       аналогом выполнения для заданных контейнеров команды **docker stop**, за которой сразу следует команда **docker start**. 
                       
- **docker rm** - Удаляет один или несколько контейнеров                       

- **docker start** - Запускает остановленный контейнер (или несколько контейнеров)

- **docker stop** - Останавливает (но не удаляет) один или несколько контейнеров

- **docker unpause** - Перезапускает контейнер, выполнение которого было приостановлено командой **docker pause**

- **docker info** - Выводит различную информацию о системе Docker и хосте, на котором она работает

- **docker port** - Выводит список отображений открытых портов для заданного контейнера

- **docker ps** - Предоставляет общую информацию о работающих контейнерах: имя, идентификатор, состояние

- **docker top** - Предоставляет информацию о процессах, выполняющихся внутри заданного контейнера

- **docker images** - Выводит список локальных образов, содержащий такую информацию, как имя репозитория, имя тега, размер и др.

- **docker save** - Сохраняет именованные образы или репозитории в tar-архив,
	- `docker save -o /tmp/redis.tar redis:latest`
	
- **docker login** - Выполняет процедуру регистрации или входа на заданный сервер реестра

- **docker logout** - Выполняет процедуру выхода из реестра Docker.

- **docker pull** - Загружает заданный образ из реестра

- **docker push** - Выгружает образ или репозиторий в заданный реестр 
	- `docker push linnikoleh/cowsay-dockerfile `
	
- **docker search** - Выводит список общедоступных репозиториев из реестра Docker Hub	

## Dockerfile	
	
```text
 Dockerfile – это обычный текстовый файл, содержащий набор операций, которые
 могут быть использованы для создания Docker-образа	
```

- **FROM** - определяет базовый образ ОС (это, как и ранее, debian, но сейчас мы уточнили, что необходимо воспользоваться конкретной версией «wheezy»). 
             Основной образ определяется в форме IMAGE:TAG (например, debian:wheezy)
  			 Является строго обязательной для всех файлов Dockerfile как самая первая незакомментированная инструкция. 
  			 Эта инструкция обязательно должна быть самой первой в Dockerfile
	- `FROM debian:wheezy`  	
	
- **RUN** - определяют команды, выполняемые в командной оболочке внутри данного образа	
	- `RUN apt-get update && apt-get install -y cowsay fortune`
	
- **ENTRYPOINT** - инструкция позволяет определить выполняемый файл, который будет вызываться для обработки любых аргументов, переданных в команду `docker run`.
	- `ENTRYPOINT ["/usr/games/cowsay"]`
	- `ENTRYPOINT ["/entrypoint.sh"]`

- **COPY** - копирует файл из файловой системы хоста в файловую систему образа, где первый аргумент определяет файл хоста, 
			 а второй – целевой путь, таким образом, эта инструкция очень похожа на обычную команду `cp`.
			 
- **VOLUME** - Тома (volumes) – это файлы или каталоги, которые смонтированы непосредственно на хосте 		 
	
- **ADD** - Копирует файлы из контекста создания или из удаленных URL-ссылок в создаваемый образ.

- **CMD** - Запускает заданную инструкцию во время инициализации контейнера

- **ENV** - Определяет переменные среды внутри образа
	- `ENV MY_VERSION 1.3`
	
- **EXPOSE** -	Сообщает механизму Docker о том, что в данном контейнере будет существовать процесс, прослушивающий заданный порт или несколько портов

- **MAINTAINER** - Определяет метаданные об авторе «Author» для создаваемого образа в заданной строке

- **ONBUILD** - Определяет инструкцию, которая должна выполняться позже, когда данный образ будет использоваться как основной уровень для другого образа

- **USER** - Задает пользователя (по имени или по идентификатору UID) для использования во всех последующих инструкциях RUN, CMD, ENTRYPOINT.

- **WORKDIR** - Определяет рабочий каталог для всех последующих инструкций RUN, CMD, ENTRYPOINT, ADD, COPY. 

	